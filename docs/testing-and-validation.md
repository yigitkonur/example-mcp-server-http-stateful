# Testing and Validation

This document defines the recommended verification workflow for both:

- the root project in this repository
- projects generated by the scaffold creator CLI

## 1. Root Project Sanity

```bash
npm install
npm run ci
```

This runs:

- typecheck
- lint
- formatting checks
- build
- smoke test

## 2. `mcp-cli` Tool-Level Verification

Install/check CLI:

```bash
which mcp-cli || curl -fsSL https://raw.githubusercontent.com/philschmid/mcp-cli/main/install.sh | bash
mcp-cli --help
```

Prepare `mcp_servers.json` (HTTP example):

```json
{
  "mcpServers": {
    "my-server": {
      "url": "http://127.0.0.1:1453/mcp"
    }
  }
}
```

Run framework flow:

```bash
MCP_NO_DAEMON=1 mcp-cli -c mcp_servers.json
MCP_NO_DAEMON=1 mcp-cli -c mcp_servers.json info my-server -d
MCP_NO_DAEMON=1 mcp-cli -c mcp_servers.json info my-server my-tool
MCP_NO_DAEMON=1 mcp-cli -c mcp_servers.json call my-server my-tool '{"valid":"input"}'
MCP_NO_DAEMON=1 mcp-cli -c mcp_servers.json call my-server my-tool '{}'
```

## 3. Primitive-Level Validation Beyond Tool Calls

`mcp-cli` is tool-centric. For full primitive coverage, add direct JSON-RPC checks in one persistent session:

- `initialize`
- `tools/list`, `tools/call`
- `resources/list`, `resources/read`
- `prompts/list`, `prompts/get`
- `GET /mcp` SSE stream
- `DELETE /mcp` session close

This repository has already been validated with that model for both root and scaffold-generated projects.

## 4. Scaffold Project Verification

Generate and verify:

```bash
npm run create -- init my-check --dir /tmp --force
cd /tmp/my-check
npm install
npm run typecheck
npm run build
```

Then run the same `mcp-cli` and primitive-level checks against the scaffold server endpoint.

## 5. Fresh-Connection Rule

After rebuilds, always use fresh `mcp-cli` connections to avoid daemon cache confusion:

```bash
MCP_NO_DAEMON=1 mcp-cli ...
```
